<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto|Varela+Round" />
<link
  rel="stylesheet"
  href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
/>
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" />
<link
  rel="stylesheet"
  href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
/>
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>
<script>
  const myDialog = document.querySelector('#my-dialog');
  myDialog.showModal();

  function closeDialog() {
    myDialog.close();
  }

  $(document).ready(function () {
    // Activate tooltip
    $('[data-toggle="tooltip"]').tooltip();

function closeDialog() {
  myDialog.close();
}

$(document).ready(function(){
	// Activate tooltip
	$('[data-toggle="tooltip"]').tooltip();

	// Select/Deselect checkboxes
	var checkbox = $('table tbody input[type="checkbox"]');
	$("#selectAll").click(function(){
		if(this.checked){
			checkbox.each(function(){
				this.checked = true;
			});
		} else{
			checkbox.each(function(){
				this.checked = false;
			});
		}
	});
	checkbox.click(function(){
		if(!this.checked){
			$("#selectAll").prop("checked", false);
		}
	});
});
</script>
<body>
	<br><br>
	<div class="container-fluid">
		<div class="container">
		  <div class="row">
			<div class="col-sm-6">
			  <h2>Mantenimiento de <b>Tareas</b></h2>
			</div>
			

			<div class="col-sm-6 text-right">
			  <!-- Botón para crear tareas en la misma fila que el título -->
			  <button mat-raised-button color="primary" (click)="openDialog()">
				<mat-icon>add</mat-icon> Crear Tarea
			  </button>
			</div>
			<div class="col-sm-6">
            <mat-form-field appearance="fill">
            <mat-label>Buscar tareas</mat-label>
            <mat-icon matPrefix>search</mat-icon>
              <input
                matInput
                type="text"
                id="searchInput"
                [(ngModel)]="searchTerm"
                (ngModelChange)="applyFilter()"
              />
            </mat-form-field>
          	</div>
		  </div>
			<div class="table-responsive">
				<mat-table [dataSource]="filteredTasks" matSort >  <!---->

					<ng-container *ngFor="let column of ['name']" matColumnDef="name">
						<mat-header-cell *matHeaderCellDef>Nombre</mat-header-cell>
						<mat-cell *matCellDef="let task">{{ task.name }}</mat-cell>
					</ng-container>

					<ng-container *ngFor="let column of ['description'] " matColumnDef="description">
						<mat-header-cell *matHeaderCellDef>Descripción</mat-header-cell>
						<mat-cell *matCellDef="let task">{{ task.description }}</mat-cell>
					</ng-container>

					<ng-container *ngFor="let column of ['dateDue']" matColumnDef="dateDue">
						<mat-header-cell *matHeaderCellDef>Fecha Limite</mat-header-cell>
						<mat-cell *matCellDef="let task">{{ task.dateDue }}</mat-cell>
					</ng-container>

					<ng-container *ngFor="let column of ['statusId'] " matColumnDef="statusId">
						<mat-header-cell *matHeaderCellDef>Estado</mat-header-cell>
						<mat-cell *matCellDef="let task">{{ task.statusId }}</mat-cell>
					</ng-container>

					<ng-container *ngFor="let column of ['priorityId']" matColumnDef="priorityId">
						<mat-header-cell *matHeaderCellDef>Prioridad</mat-header-cell>
						<mat-cell *matCellDef="let task">{{ task.priorityId }}</mat-cell>
					</ng-container>

					<ng-container *ngFor="let column of ['projectId']" matColumnDef="projectId"> 
						<mat-header-cell *matHeaderCellDef>Proyecto</mat-header-cell>
						<mat-cell *matCellDef="let task">{{ task.projectId }}</mat-cell>
					</ng-container> 
					
					<ng-container *ngFor="let column of ['userId']" matColumnDef="userId"> 
						<mat-header-cell *matHeaderCellDef>Asignado</mat-header-cell>
						<mat-cell *matCellDef="let task">{{ task.userId }}</mat-cell>
					</ng-container>

					<ng-container *ngFor="let column of ['actions']" matColumnDef="actions">
						<mat-header-cell *matHeaderCellDef>Acciones</mat-header-cell>
						<mat-cell *matCellDef="let task">
							<button mat-icon-button (click)="openDialogEditar(task)" matTooltip="Editar">
							<mat-icon>edit</mat-icon>
							</button>
							<button mat-icon-button (click)="openEliminar(task)" matTooltip="Eliminar">
							<mat-icon>delete</mat-icon>
							</button>
						</mat-cell>
					</ng-container>

					<mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
					<mat-row *matRowDef="let row; columns: displayedColumns"></mat-row>



				</mat-table>
			</div>
		</div>
	</div>



